# AquaScore 儀表板 - Wireframe 與功能需求文件

## 一、總覽 (Overview)

本文件旨在定義 AquaScore 個人化數據儀表板的介面佈局 (Wireframe) 與功能需求。此儀表板的核心目標是讓游泳運動員能透過簡易的操作，查詢、追蹤並分析自己的比賽成績，並透過**全局的數據引導**，清晰地理解各項指標的涵義與**實用價值**，從而獲得真正可操作的訓練洞察。

儀表板採用**分頁 (Tab) 設計**，將主要功能清晰地劃分為兩個獨立的視圖：
1.  **整體表現分析**：採用「總覽後鑽取 (Summary then Drill-down)」的設計模式，先呈現各項目的 PB 關鍵指標總覽，再讓使用者點擊以進入擁有進階圖表分析功能的詳細視圖。
2.  **特定競賽查詢**：微觀地深入某一次特定比賽，分析其中的所有項目表現，並透過圖表與數據，與其他選手進行對比。

---

## 二、完整 Wireframe

### 2.1 主要介面結構

```
+------------------------------------------------------------------------------------------------------+
|                                                                                                      |
|   /-\                                                                                                |
|  |o o|  AquaScore  儀表板                                                                            |
|   \_/                 運動員姓名: [ 王小明              ] (搜尋)                                       |
|                                                                                                      |
+------------------------------------------------------------------------------------------------------+
|                                                                                                      |
|   [-- 整體表現分析 --]  [-- 特定競賽查詢 --]                                                           |
|  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  |
|                                                                                                      |
|   (此處為當前選中分頁的內容區域)                                                                       |
|                                                                                                      |
+------------------------------------------------------------------------------------------------------+
```

### 2.2 「整體表現分析」分頁內容

#### **上半部：個人最佳成績總覽 (洞察卡片式)**

```
╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║  🏆 個人最佳成績總覽 (All-Time Personal Bests)                                                     ║
║  ──────────────────────────────────────────────────────────────────────────────────  ║
║                                                                                                    ║
║   +------------------------------------------------------------------------------------------------+
║   | 🏊 50公尺自由式                                       [深入分析 »]                             |
║   |------------------------------------------------------------------------------------------------|
║   |                                                                                                |
║   |  ⭐ PB: 24.98s (於 2024/10/19, 🔴 久未更新 (i))                                                 |
║   |                                                                                                |
║   |  [指標] 穩定度: 🟡 中等 (i)  |  近三場趨勢: ↔ 穩定 (+0.33s vs PB) (i)                        |
║   |                                                                                                |
║   |  [趨勢] 近一年表現:  ▂▄ █▄▂ (Sparkline) (i)   |  平均差距: +0.44s vs PB                    |
║   +------------------------------------------------------------------------------------------------+
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝
```

#### **下半部：項目洞察分析 (Drill-down Detail)**

```
╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║  🎯 項目洞察分析: 50公尺自由式                                                                     ║
║                                                                                                    ║
║    篩選條件:   時間區間: [ 過去一年 (▾) ]     圖表選項: [x] 顯示移動平均/穩定區間                 ║
║  ──────────────────────────────────────────────────────────────────────────────────  ║
║   +---------------------------------------------+ +----------------------------------------------+
║   | 📈 成績趨勢圖                               | | 📈 最近表現分析                              |
║   |  (滑鼠懸停數據點可看詳細賽事資訊)           | |  - 最近成績: 25.25s (差距PB: +0.27s)       |
║   |  (灰色區間為標準差計算的穩定度範圍)       | |  - 近三場平均: 25.31s (差距PB: +0.33s)       |
║   |  ^                                          | |  - 近三場趨勢: 穩定持平 [↔]              |
║   |成績|⭐.  /▔▔▔\                             | |  - 穩定度分數: 85/100 (變異係數低)       |
║   |   |/ \ `' (     )                          | |  - 巔峰狀態評估: 接近 (在 PB 1.1% 內)    |
║   |   +----->\_____/--------------------------> |
║   |            賽事日期                         | |                                              |
║   |  ───────────────────────────  | |                                              |
║   |  [ 近三場 vs PB 差距 (Bar Chart) ]          | |                                              |
║   |  +0.5s |   █                                 | |                                              |
║   |  +0.0s |─ ─ █ ─ ─ ─ ─ ─ ─ ─                | |                                              |
║   |  -0.5s |     █                             | |                                              |
║   |        +----------------------------------->|
║   |          -3場 -2場 -1場                     |
║   +---------------------------------------------+ +----------------------------------------------+
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝
```

### 2.3 「特定競賽查詢」分頁內容

當「特定競賽查詢」分頁被選中時，篩選方式已更新為級聯篩選。

```
╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║  🏊 特定競賽查詢                                                                                   ║
║   (用於查詢運動員在某次特定比賽中的所有項目成績，並可查看與其他名次選手的成績對比)                 ║
║  ──────────────────────────────────────────────────────────────────────────────────  ║
║                                                                                                    ║
║    篩選條件:   年份: [ 2025 (▾) ]         競賽名稱: [ 全國大專校院運動會 (▾) ]                     ║
║               (先選擇年份，再從該年份的賽事列表中選擇競賽)                                           ║
║                                                                                                    ║
║   +------------------------------------------------------------------------------------------------+ 
║   | 比賽結果 (顯示運動員在 "2025 全國大專校院運動會" 中的所有項目成績)                             |
║   |------------------------------------------------------------------------------------------------|
║   | 賽事日期   | 項目 (▾)         | 組別       | 個人成績 | 名次 | 成績對比     | 備註         | 
║   |------------|------------------|------------|----------|------|--------------|--------------| 
║   | 2025/04/26 | 50公尺自由式     | 公開男子組 | 25.15s   | 8    | [查看]       |              | 
║   | ...        | ...              | ...        | ...      | ...  | ...          |              | 
║   +------------------------------------------------------------------------------------------------+ 
║   (點擊「成績對比」將彈出以下視窗或展開以下詳細區塊)                                                 ║
║                                                                                                    ║
║   ╔════════════════════════════════════════════════════════════════════════════════════════════╗ ║
║   ║  對比分析: 114年全國大專校院運動會 - 50公尺自由式 (公開男子組)                              ║ ║
║   ║  ──────────────────────────────────────────────────────────────────────────  ║ ║
║   ║  [ 📈 成績分佈圖 & 差距柱狀圖 (i) ]                                                          ║ ║
║   ║   全國REC | 大會REC |                                                                      ║ ║
║   ║      |      |     1st (•)                                                                  ║ ║
║   ║      |      |         2nd (•)                                                                ║ ║
║   ║      |      |             3rd (•)                                                            ║ ║
║   ║      |      |            ...                                                                 ║ ║
║   ║      |      |                     6th (•)                                                    ║ ║
║   ║      |      |                        7th (•)                                                 ║ ║
║   ║      |      |                            8th (🔵 您)                                       ║ ║
║   ║      |      |                                                                               ║ ║
║   ║      +------+----------------------------------------------------------------------------> ║ ║
║   ║      22s    23s     24s     25s     26s                                         成績 (秒)    ║ ║
║   ║  ──────────────────────────────────────────────────────────────────────────  ║ ║
║   ║    [ 您與其他名次的差距 (Bar Chart) (i) ]                                                            ║ ║
║   ║     +0.0s ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─                                           ║ ║
║   ║     +0.5s |             █ (11th)                                                              ║ ║
║   ║     +0.0s |                 █ (8th)                                                           ║ ║
║   ║     -0.5s |     █ (7th) █ (6th)                                                                 ║ ║
║   ║     -1.0s |         █ (3rd)                                                                     ║ ║
║   ║     -1.5s |   █ (2nd)                                                                           ║ ║
║   ║     -2.0s █ (1st)                                                                               ║ ║
║   ║           +-----------------------------------------------------------------------------------> ║ ║
║   ║                   1st 2nd 3rd ... 6th 7th 8th 11th                                名次          ║ ║
║   ║  ──────────────────────────────────────────────────────────────────────────  ║ ║
║   ║  [ 📋 詳細數據 ]                                                                             ║ ║
║   ║  🌟 全國紀錄: 22.10s (與您相差 -3.05s (i))                                                      ║ ║
║   ║  🏆 大會紀錄: 23.46s (與您相差 -1.69s (i))                                                      ║ ║
║   ║  您的成績: 25.15s (第 8 名)                                                                ║ ║
║   ║  +----------------------------------------------------------+                              ║ ║
║   ║  | 名次 | 姓名       | 成績     | 與您差距 (i) |                                            ║ ║
║   ║  | 1    | 張三       | 23.50s   | -1.65s (🔴)  |                                            ║ ║
║   ║  | 8    | 王小明(您) | 25.15s   | 0.00s (⚫)  |                                            ║ ║
║   ║  | 11   | 林九       | 25.40s   | +0.25s (🟢)  |                                            ║ ║
║   ║  +----------------------------------------------------------+                              ║ ║
║   ╚════════════════════════════════════════════════════════════════════════════════════════════╝ ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝
```

---

## 三、功能區塊詳解

### 3.1 全域控制 (Global Controls)

-   **運動員姓名**: 核心查詢欄位，整個儀表板的數據基礎。

### 3.2 分頁控制器 (Tab Controller)

-   **功能**: 在「整體表現分析」和「特定競賽查詢」兩個主要功能視圖之間切換。

### 3.3 「整體表現分析」分頁

此分頁採用「總覽後鑽取」的互動模式。

#### **上半部：個人最佳成績總覽**

-   **功能**: 作為此分頁的進入點，以表格形式清晰列出該運動員所有參賽項目的**歷史個人最佳 (All-Time PB)** 紀錄。
-   **互動**:
    -   表格預設載入該選手所有項目的 PB。
    -   每一行最後提供一個 `[數據分析]` 按鈕。點擊此按鈕，會觸發下方「項目洞察分析」區塊的顯示與數據載入。

#### **下半部：項目洞察分析**

-   **功能**: 在使用者選擇要深入分析的項目後，提供該項目的詳細趨勢圖與洞察指標。
-   **互動**: 此區塊預設為隱藏或不活動狀態。點擊上方 PB 總覽表格中的 `[數據分析]` 按鈕後出現。
-   **篩選條件**:
    -   **時間區間**: 允許使用者篩選此詳細分析區塊的時間範圍，包含預設選項（如 `過去一年`）及「自訂」起訖日期的功能。
    -   **圖表選項**: 提供 `[x] 顯示移動平均線` 等進階圖表功能。
-   **圖表與洞察卡**:
    -   **成績趨勢圖**:
        -   **設計**: 當選擇單一項目時，顯示大型折線圖。為避免混淆，在此「鑽取」模式下，建議只分析單一項目。
        -   **進階標記**:
            -   **PB 標記 (⭐)**: 在折線上用特殊圖示標示出該時間區間內的個人最佳成績點。
            -   **移動平均線 (---)**: 若使用者勾選，疊加一條平滑趨勢線。
    -   **最近表現分析 (Insight Card)**:
        -   **功能**: 針對所選項目，提供豐富的自動化洞察指標。
        -   **數據引導**: 所有進階指標旁都提供 `(i)` 資訊圖示，滑鼠懸停時顯示其詳細定義（參考附錄A）。

### 3.4 「特定競賽查詢」分頁

此分頁用於深入查詢單一賽事並進行選手對比。

-   **篩選條件 (級聯篩選)**:
    -   **互動流程**: 採用兩步驟篩選，以應對大量的賽事數據。
        1.  **年份**: 使用者先從下拉選單中選擇「年份」。
        2.  **競賽名稱**: 「競賽名稱」的下拉選單內容，會**根據所選的年份動態更新**，只顯示該年度的所有比賽。
    -   **優勢**: 此設計能大幅縮小選擇範圍，讓使用者可以快速且準確地定位到目標賽事。
-   **比賽結果表格**:
    -   **功能**: 列表顯示運動員在該競賽中的所有參賽項目及其成績。
    -   **互動**: 點擊每行提供的 `[查看]` 按鈕，觸發「對比分析」視窗。
-   **對比分析視窗 (視覺化強化版)**:
    -   **功能**: 將使用者的成績與該場次的其他選手及關鍵紀錄進行全面的視覺化與數據化比較。
    -   **數據引導**: 所有圖表標題和關鍵指標旁都提供 `(i)` 資訊圖示，滑鼠懸停時顯示其詳細定義（參考附錄A）。

---

## 四、設計原則與響應式指南

### 4.1 響應式 / 小屏幕顯示 (Responsive Design)

為了確保儀表板在平板和手機等小屏幕設備上依然易於使用和閱讀，所有區塊都應遵循響應式設計原則。

-   **PB 總覽 (洞察卡片式)**:
    -   在桌面等寬屏幕上，卡片可以並排顯示（若空間允許）。
    -   在手機等窄屏幕上，卡片應**自動堆疊為單欄**，垂直排列，確保每張卡片的內容都能完整顯示而無需水平滾動。

-   **項目洞察分析 (Drill-down Detail)**:
    -   在桌面螢幕上，`📈 成績趨勢圖` 和 `📈 最近表現分析` 兩個子區塊可以左右並排。
    -   在手機螢幕上，這兩個子區塊應**自動堆疊為垂直排列**，通常是圖表在上，文字指標在下。

-   **特定競賽查詢 (對比分析視窗)**:
    -   `📈 成績分佈圖 (Gap Chart)` 和 `差距柱狀圖 (Bar Chart)` 由於其水平特性，在極窄的螢幕上可能難以完整顯示。
    -   **策略**: 應允許此圖表區塊在其容器內**產生水平捲軸**，讓使用者可以左右滑動來查看完整的圖表，而非將圖表縮小到難以辨識的程度。詳細數據表格同樣適用此原則。

### 4.2 整合圖表顏色語義 (Consistent Color Semantics)

為了讓使用者能夠快速、直觀地理解圖表中不同元素的意義，整個儀表板應遵循一套統一的顏色規則。

-   **核心指標顏色**:
    -   **⭐ 個人最佳 (PB)**: 使用 **金色** 或 **亮橘色 (Gold / Bright Orange)**。這代表了運動員的「黃金標準」或最高成就，應在所有圖表和卡片中保持一致。
    -   **🔵 您 / 最近成績**: 使用**主色調藍色 (Primary Blue)**。這代表了當前分析的主體，無論是數據點、長條還是表格中的高亮，都應使用此顏色。
    -   **🥇 第一名**: 使用 **金色**。
    -   **🥈 第二名**: 使用 **銀色**。
    -   **🥉 第三名**: 使用 **銅色**。

-   **參考標竿顏色**:
    -   **紀錄標竿 (全國/大會)**: 使用**中性深灰色**或**紫色 (Neutral Dark Gray / Purple)**。這代表一個客觀、穩重的參考標準，應避免使用帶有強烈正面或負面情緒的顏色。
    -   **移動平均線**: 使用與主色調藍色協調的**輔助色**（如淺藍色或灰色），並以**虛線**形式呈現，以區分於實際的成績數據。
    -   **穩定度區間帶**: 使用移動平均線顏色的**半透明版本**，以創建一個不干擾主數據的背景區域。

-   **差距與趨勢顏色 (預設)**:
    -   **🟢 進步/優於**: 當數據表示「比...快」或「趨勢上升」時，使用**綠色系**。例如，「與您差距」為負數時，或「最近三場趨勢」為 `↑` 時。
    -   **🔴 落後/劣於**: 當數據表示「比...慢」或「趨勢下降」時，使用**紅色系**。例如，「與您差距」為正數時，或「最近三場趨勢」為 `↓` 時。
    -   **⚫ 中性/持平**: 當數據表示持平或自身時，使用**中性灰色或黑色**。
    -   **🟠 / 🟡**: 用於表示中等或特定程度的差距。

#### **4.2.1 無障礙設計：色盲友好模式 (Accessibility: Colorblind-Friendly Mode)**

**核心原則**：**絕不單獨依賴顏色**來傳達重要資訊。必須結合**形狀、圖示、文字標籤**來確保資訊的無障礙傳遞。

-   **實作方式**：
    1.  為照顧紅綠色弱等辨色力異常的使用者，系統應優先採用或提供可切換的色盲友好配色方案。
    2.  所有現存的圖示（如 `↑`, `↓`, `↔`, `⭐`）、數字標籤（如 `+0.25s`）以及文字說明都必須保留，它們是獨立於顏色的主要資訊來源。

-   **建議的色盲友好替代顏色方案**:
    -   `🟢 進步/優於` 應替換為 → `🔵 **藍色系**` (例如，用於表示比使用者快的成績差距)。
    -   `🔴 落後/劣於` 應替換為 → `🟠 **橘色/黃色系**` (例如，用於表示比使用者慢的成績差距)。

遵循這些原則，將能極大提升儀表板的專業度和使用者體驗的包容性。

---

## 五、數據需求

-   需要 `Race` (賽事) 和 `RaceResult` (賽事結果) 兩個核心資料模型。
-   `Race` 應包含：賽事ID, 競賽名稱, 年份, 日期, 項目名稱, 組別, 全國紀錄, 大會紀錄等。
-   `RaceResult` 應包含：結果ID, 賽事ID (外鍵), 選手姓名, 單位, 成績, 名次, 分數, 備註等。
-   儀表板功能大量依賴於 `Race` 和 `RaceResult` 之間的關聯查詢，以及對 `RaceResult` 的聚合與排序運算。

---

## 附錄 A：數據引導指標詳解

### A.1 「整體表現分析」-> 洞察卡片 (Insight Cards)

-   **PB 更新時間 `(i)`**:
    -   **說明文字**: "此燈號**反映您突破個人極限的頻率**。綠燈代表近期狀態火熱，是衝擊好成績的良機；紅燈則可能表示您遇到了瓶頸期，是時候檢視訓練計畫了。"
    -   **判定條件**:
        -   `🟢`: 距今 **0-3 個月內**。
        -   `🟡`: 距今 **3-6 個月**。
        -   `🔴`: 距今 **超過 6 個月**。

-   **穩定度 `(i)`**:
    -   **說明文字**: "**用於評估您的表現是否可靠**。高穩定度代表您的實力已穩固在一個水平；低穩定度（成績起伏大）則表示您的PB可能帶有偶然性，需加強訓練以鞏固表現。"
    -   **計算參考**: 根據此項目最近 5 場有效成績的**變異係數(CV)**計算。

-   **近三場趨勢 `(i)`**:
    -   **說明文字**: "**快速判斷您最近的短期狀態**。箭頭顯示您是處於上升、下降還是平穩期，旁的秒數則告訴您離自己的最佳狀態有多遠。"

-   **近一年表現 (Sparkline) `(i)`**:
    -   **說明文字**: "**提供一個長期的宏觀視角**。透過這個迷你趨勢圖，您可以快速回顧過去一整年的表現起伏與賽季週期，以規劃未來。"

### A.2 「整體表現分析」-> 項目洞察分析 (Drill-down Detail)

-   **趨勢圖資料點 Tooltip**:
    -   **說明文字**: "當滑鼠懸停在趨勢圖上的任一數據點時，彈出一個資訊框，顯示該場比賽的詳細資訊：**『賽事名稱』、『比賽階段(預賽/決賽)』、『成績』與『日期』**。"

-   **與PB差距 `(i)`**:
    -   **說明文字**: "**衡量單次表現的指標**。這個數字直接告訴您，最近的這次比賽發揮出了您巔峰實力的幾成。"

-   **近三場平均 vs PB `(i)`**:
    -   **說明文字**: "**衡量您當前「平均實力」的指標**。相較於單次成績，這個數字更能反映您目前穩定的實力水平與巔峰時期的差距。"

-   **近三場趨勢 `(i)`**:
    -   **說明文字**: "**判斷短期訓練成效**。此趨勢線由最近三場成績計算而來，是判斷您近期訓練調整是否有效的直接參考。"

-   **穩定度分數 `(i)`**:
    -   **說明文字**: "**評估您在特定賽季或時間段內的表現一致性**。分數越高，代表您能穩定地游出接近的成績，是實力成熟的象徵。"

-   **巔峰狀態評估 `(i) `**:
    -   **說明文字**: "**判斷您是否處於「出成績」的巔峰區間**。若近期成績穩定在PB的2%以內，代表您已進入或接近個人巔峰，是參加重要賽事的好時機。"

### A.3 「特定競賽查詢」-> 對比分析視窗 (Comparison View)

-   **成績分佈圖 & 差距柱狀圖 `(i)`**:
    -   **說明文字**: "**快速定位您在賽場上的競爭位置**。上方的分佈圖幫您看清成績的全貌，下方的差距圖則聚焦於『您與他人』的秒數差距，是制定超越目標的關鍵。"

-   **紀錄差距 (全國/大會) `(i)`**:
    -   **說明文字**: "**衡量您與頂尖水平的距離**。這個差距是您挑戰更高殿堂（如破紀錄）的具體目標。"

-   **表格欄位『與您差距』 `(i)`**:
    -   **說明文字**: "**精確計算您與特定名次選手的秒數差距**。您可以利用這個數字，設定具體的追趕目標，例如『下次比賽要比第3名快0.5秒』。"
    -   **顏色判定條件 (示例)**:
        -   `💚 大幅領先`: < -1.0s (比您快超過 1 秒)
        -   `🟢 小幅領先`: -0.01s 至 -0.99s (比您快)
        -   `⚫ 您的成績`: 0.00s
        -   `🟠 小幅落後`: +0.01s 至 +0.99s (比您慢)
        -   `🔴 大幅落後`: > +1.0s (比您慢超過 1 秒)